<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>The Path to Enlightenment - Riddle Escape Maze</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
      :root {
        --blue1: #00b0cf;
        --blue2: #6667f4;
        --blue-light-10: rgba(0, 176, 207, 0.1);
        --blue-dark-10: rgba(102, 103, 244, 0.1);
      }
      body {
        margin: 0;
        font-family: 'Poppins', sans-serif;
        background: white;
        position: relative;
      }
      .header {
        background: linear-gradient(90deg, var(--blue1), var(--blue2));
        color: white;
        padding: 100px 20px;
        text-align: center;
        font-weight: 900;
        font-size: 3.5rem;
        letter-spacing: 2px;
        line-height: 1.1;
        position: relative;
        background-image: 
          radial-gradient(rgba(255, 255, 255, 0.2) 1px, transparent 1px),
          linear-gradient(90deg, var(--blue1), var(--blue2));
        background-size: 10px 10px, cover;
      }
      .main {
        background: white;
        position: relative;
        padding: 30px 20px;
        z-index: 0;
        overflow: hidden;
      }
      .main::before {
        content: '';
        position: absolute;
        width: 600px;
        height: 600px;
        border-radius: 50%;
        background: radial-gradient(circle, #a1daff 0%, transparent 50%, transparent 100%);
        z-index: -1;
        top: -300px;
        left: -300px;
      }
      .content {
        position: relative;
        z-index: 1;
      }
      .section-title {
        font-weight: 900;
        font-size: 1.5rem;
        color: black;
        text-align: center;
        margin-bottom: 10px;
      }
      .section-title::after {
        content: '';
        display: block;
        width: 60px;
        height: 4px;
        margin: 10px auto;
        background: linear-gradient(90deg, var(--blue1), var(--blue2));
        border-radius: 2px;
      }
      .riddle-box {
        background: linear-gradient(90deg, var(--blue-light-10), var(--blue-dark-10));
        padding: 20px;
        border-radius: 10px;
        margin: 20px auto;
        max-width: 600px;
      }
      .riddle-box h3 {
        font-weight: 900;
        color: black;
        margin-top: 0;
        margin-bottom: 10px;
        font-size: 1.2rem;
        text-align: center;
      }
      .riddle-box p {
        font-style: italic;
        font-weight: 400;
        color: black;
        margin: 0;
        text-align: justify;
        font-size: 0.9rem;
      }
      .answer-section {
        margin-top: 20px;
        text-align: left;
        max-width: 600px;
        margin-left: auto;
        margin-right: auto;
      }
      .answer-options {
        list-style: none;
        margin: 0;
        padding: 0;
      }
      .answer-options li {
        font-size: 1rem;
        font-weight: 400;
        padding: 10px;
        border-bottom: 1px solid #ccc;
        cursor: pointer;
        transition: background-color 0.3s ease, color 0.3s ease, transform 0.2s ease;
      }
      .answer-options li:hover {
        background-color: #f0f8ff;
        color: #000;
        transform: translateX(3px) scale(1.02);
      }
      .answer-options li.selected {
        background-color: var(--blue-light-10);
        font-weight: 700;
      }
      .input-answer {
        width: 100%;
        padding: 10px;
        font-family: 'Poppins', sans-serif;
        font-size: 1rem;
        margin-top: 10px;
        border: 1px solid #ccc;
        border-radius: 5px;
      }
      .navigation-buttons {
        display: flex;
        justify-content: space-between;
        max-width: 600px;
        margin: 20px auto;
      }
      .nav-button {
        padding: 10px 20px;
        border: none;
        border-radius: 5px;
        background: linear-gradient(90deg, var(--blue1), var(--blue2));
        color: white;
        font-weight: 700;
        cursor: pointer;
        transition: all 0.3s ease;
        opacity: 0.9;
        font-family: 'Poppins', sans-serif;
      }
      .nav-button:hover {
        opacity: 1;
        transform: scale(1.05);
      }
      .nav-button:disabled {
        background: #cccccc;
        cursor: not-allowed;
        opacity: 0.5;
      }
      .cumulative-code {
        text-align: center;
        font-weight: 700;
        margin: 10px 0;
      }
      .path-history {
        max-width: 600px;
        margin: 20px auto;
        font-size: 0.8rem;
        color: #666;
      }
      .path-history span {
        margin-right: 5px;
        display: inline-block;
      }
      .path-history span:not(:last-child):after {
        content: "→";
        margin-left: 5px;
      }
      .final-code-section {
        text-align: center;
        margin-top: 20px;
      }
    </style>
  </head>
  <body>
    <div class="header">
      THE PATH TO<br>ENLIGHTENMENT
    </div>

    <div class="main">
      <div class="content">
        <div class="section-title">RIDDLE ESCAPE MAZE</div>

        <div class="path-history" id="path-history">
          <span>Start</span>
        </div>

        <div class="riddle-box">
          <h3 id="riddle-title">BEGIN YOUR JOURNEY</h3>
          <p id="riddle-text">
            To find the treasure, you must follow the path of enlightenment.
            As Bhrigu, each task you complete yields a one‐digit code based solely on your answer’s order.
            At the end, your cumulative code must be correct to unlock the mystery.
          </p>
        </div>

        <!-- Cumulative code display -->
        <div class="cumulative-code" id="cumulative-code">
          Your Code So Far: <span id="code-so-far"></span>
        </div>

        <!-- Multiple-choice answer section -->
        <div class="answer-section" id="multiple-choice-section" style="display: none;">
          <ul class="answer-options" id="answer-options">
            <!-- Options populated by JavaScript -->
          </ul>
        </div>

        <!-- Text input answer section -->
        <div class="answer-section" id="text-input-section" style="display: none;">
          <input type="text" id="text-answer" class="input-answer" placeholder="Enter your answer">
          <button class="nav-button" id="submit-text-answer" style="margin-top: 10px; width: 100%;">Submit Answer</button>
        </div>

        <div class="navigation-buttons">
          <button class="nav-button" id="prev-button" disabled>Back</button>
          <button class="nav-button" id="next-button">Begin Journey</button>
        </div>

        <!-- Final code input section (shown at end) -->
        <div class="final-code-section" id="final-code-section" style="display: none;">
          <p>To solve the mystery, enter your cumulative code:</p>
          <input type="text" id="final-code-input" class="input-answer" placeholder="Enter final code" style="width: 80%; margin-bottom: 10px;">
          <button class="nav-button" id="final-code-submit" style="width: 80%;">Submit Final Code</button>
          <p id="final-code-feedback" style="color: red; font-weight: bold;"></p>
        </div>
      </div>
    </div>

    <script>
      // Riddle data with 20 questions; each includes an excerpt (in italic) between the title and question.
      const riddleData = {
        start: {
          title: "BEGIN YOUR JOURNEY",
          text: "To find the treasure, you must follow the path of enlightenment. As Bhrigu, each task you complete yields a one‐digit code based solely on your answer’s order. At the end, your cumulative code must be correct to unlock the mystery.",
          nextRiddle: "q1",
          answerType: "none"
        },
        q1: {
          title: "14. The Star",
          excerpt: "Guiding light in the darkness.",
          text: "I shine in the night sky, guiding lost souls. What am I?",
          options: ["Moon", "Star", "Comet", "Sun"],
          correctAnswer: "Star",
          nextRiddle: "q2"
        },
        q2: {
          title: "3. The Trickster",
          excerpt: "The force behind your thoughts.",
          text: "I am the architect of your perceptions. I create your world through thoughts. What am I?",
          options: ["Soul", "Breath", "Mind", "Heart"],
          correctAnswer: "Mind",
          nextRiddle: "q3"
        },
        q3: {
          title: "7. Liberation",
          excerpt: "Freedom from the cycle of illusion.",
          text: "I am the key to breaking free from endless cycles. What is the path to liberation?",
          options: ["Truth", "Enlightenment", "Knowledge", "Faith"],
          correctAnswer: "Truth",
          nextRiddle: "q4"
        },
        q4: {
          title: "1. The Outer Shell",
          excerpt: "The physical form that carries life's experiences.",
          text: "I am the vessel that carries you through life. I feel pleasure and pain, hot and cold. What am I?",
          options: ["Soul", "Body", "Mind", "Spirit"],
          correctAnswer: "Body",
          nextRiddle: "q5"
        },
        q5: {
          title: "18. The Labyrinth of Thoughts",
          excerpt: "The complexity within your mind.",
          text: "I represent the maze within your mind, where thoughts wander. What am I?",
          options: ["Enigma", "Labyrinth", "Puzzle", "Maze"],
          correctAnswer: "Labyrinth",
          nextRiddle: "q6"
        },
        q6: {
          title: "12. The River",
          excerpt: "Ever flowing, never stagnant.",
          text: "I am the flow that never ceases, carving paths through time. What am I?",
          options: ["Stream", "Time", "River", "Flow"],
          correctAnswer: "River",
          nextRiddle: "q7"
        },
        q7: {
          title: "16. The Whisper",
          excerpt: "Subtle messages from the universe.",
          text: "I carry secrets on the wind, softly spoken. What am I?",
          options: ["Sound", "Silence", "Whisper", "Word"],
          correctAnswer: "Whisper",
          nextRiddle: "q8"
        },
        q8: {
          title: "20. The Final Riddle",
          excerpt: "The culmination of your journey.",
          text: "I encapsulate the essence of all that is and was. What am I?",
          options: ["Infinity", "Brahman", "Void", "Eternity"],
          correctAnswer: "Brahman",
          nextRiddle: "q9"
        },
        q9: {
          title: "10. The Flame",
          excerpt: "The spark of creativity and life.",
          text: "I burn bright within, fueling your spirit and creativity. What am I?",
          options: ["Fire", "Energy", "Desire", "Passion"],
          correctAnswer: "Fire",
          nextRiddle: "q10"
        },
        q10: {
          title: "6. The All",
          excerpt: "The universal force that binds everything.",
          text: "I am the ultimate reality, the underlying essence of all things. What am I?",
          options: ["Brahman", "Existence", "Universe", "Consciousness"],
          correctAnswer: "Brahman",
          nextRiddle: "q11"
        },
        q11: {
          title: "8. The Echo",
          excerpt: "A reflection of your inner self.",
          text: "I resonate with every thought you have, yet I remain unseen. What am I?",
          options: ["Echo", "Voice", "Thought", "Silence"],
          correctAnswer: "Echo",
          nextRiddle: "q12"
        },
        q12: {
          title: "5. The Witness",
          excerpt: "The silent observer within.",
          text: "I am the silent witness behind your thoughts, constant and unchanging. Who am I?",
          options: ["Mind", "Atman", "Intellect", "Consciousness"],
          correctAnswer: "Atman",
          nextRiddle: "q13"
        },
        q13: {
          title: "17. The Dawn",
          excerpt: "A new beginning after the night.",
          text: "I herald the start of a new day, full of promise. What am I?",
          options: ["Morning", "Dawn", "Sunrise", "Light"],
          correctAnswer: "Dawn",
          nextRiddle: "q14"
        },
        q14: {
          title: "15. The Tree",
          excerpt: "Rooted in the earth, reaching for the sky.",
          text: "I stand tall and strong, providing shelter and wisdom. What am I?",
          options: ["Tree", "Forest", "Mountain", "River"],
          correctAnswer: "Tree",
          nextRiddle: "q15"
        },
        q15: {
          title: "2. The Five Illusions",
          excerpt: "Five perceivers that shape your reality.",
          text: "Five sisters dwell within you, each perceiving the world in her own way. What are they called?",
          options: ["Chakras", "Senses", "Emotions", "Elements"],
          correctAnswer: "Senses",
          nextRiddle: "q16"
        },
        q16: {
          title: "4. The Mask",
          excerpt: "Your outer identity, ever-changing.",
          text: "I am the persona you display to the world, crafted from memories and desires. What am I?",
          options: ["Karma", "Maya", "Ego", "Dharma"],
          correctAnswer: "Ego",
          nextRiddle: "q17"
        },
        q17: {
          title: "19. The Cosmic Dance",
          excerpt: "The interplay of energies in the universe.",
          text: "I am the eternal dance of creation and destruction. What am I?",
          options: ["Order", "Cosmos", "Chaos", "Dance"],
          correctAnswer: "Cosmos",
          nextRiddle: "q18"
        },
        q18: {
          title: "13. The Wind",
          excerpt: "Invisible yet all‐pervasive.",
          text: "I am felt but never seen, moving everything in my wake. What am I?",
          options: ["Breath", "Spirit", "Air", "Wind"],
          correctAnswer: "Wind",
          nextRiddle: "q19"
        },
        q19: {
          title: "11. The Mirror",
          excerpt: "Reflections of your inner truth.",
          text: "I show you a reflection that is both true and deceptive. What am I?",
          options: ["Illusion", "Reflection", "Mirror", "Shadow"],
          correctAnswer: "Mirror",
          nextRiddle: "q20"
        },
        q20: {
          title: "9. The Labyrinth",
          excerpt: "The maze of choices in life.",
          text: "I am the intricate maze that represents the choices you make. What do I symbolize?",
          options: ["Maze", "Path", "Journey", "Destiny"],
          correctAnswer: "Path",
          nextRiddle: "completion"
        },
        completion: {
          title: "Journey Complete",
          text: "You have reached the end of your journey. Now, to unlock the mystery, enter your cumulative code below.",
          isFinal: true
        }
      };

      // Game state variables
      let currentRiddle = "start";
      let visitedRiddles = ["start"];
      // Store answers (digit for each question, keyed by riddle ID)
      let answers = {};

      // DOM elements
      const riddleTitle = document.getElementById("riddle-title");
      const riddleText = document.getElementById("riddle-text");
      const multipleChoiceSection = document.getElementById("multiple-choice-section");
      const textInputSection = document.getElementById("text-input-section");
      const answerOptions = document.getElementById("answer-options");
      const textAnswer = document.getElementById("text-answer");
      const submitTextAnswer = document.getElementById("submit-text-answer");
      const prevButton = document.getElementById("prev-button");
      const nextButton = document.getElementById("next-button");

      // Update cumulative code display (shows "_" for unanswered questions)
      function updateCumulativeCodeDisplay() {
        let codeSoFar = "";
        for (let i = 1; i < visitedRiddles.length; i++) {
          let qid = visitedRiddles[i];
          codeSoFar += answers[qid] ? answers[qid] : "_";
        }
        document.getElementById("code-so-far").textContent = codeSoFar;
      }

      // Update path history display
      function updatePathHistory() {
        const historyElem = document.getElementById("path-history");
        historyElem.innerHTML = "";
        const startSpan = document.createElement("span");
        startSpan.textContent = "Start";
        historyElem.appendChild(startSpan);
        for (let i = 1; i < visitedRiddles.length; i++) {
          const rid = visitedRiddles[i];
          if (rid === "completion") continue;
          const span = document.createElement("span");
          let displayTitle = riddleData[rid].title;
          if (displayTitle.includes(". ")) {
            displayTitle = displayTitle.split(". ")[1];
          } else if (displayTitle.includes(": ")) {
            displayTitle = displayTitle.split(": ")[1];
          }
          span.textContent = displayTitle;
          historyElem.appendChild(span);
        }
      }

      // Load a riddle by its ID
      function loadRiddle(riddleId) {
        const riddle = riddleData[riddleId];
        riddleTitle.textContent = riddle.title;
        // If an excerpt exists, show it in italic below the title and before the main text.
        if (riddle.excerpt) {
          riddleText.innerHTML = "<em>" + riddle.excerpt + "</em><br><br>" + riddle.text;
        } else {
          riddleText.textContent = riddle.text;
        }
        multipleChoiceSection.style.display = "none";
        textInputSection.style.display = "none";
        nextButton.disabled = true;
        if (riddle.isFinal) {
          nextButton.style.display = "none";
          prevButton.style.display = "none";
          document.getElementById("final-code-section").style.display = "block";
        } else {
          document.getElementById("final-code-section").style.display = "none";
          nextButton.style.display = "inline-block";
          prevButton.style.display = "inline-block";
          if (riddle.answerType === "text") {
            textInputSection.style.display = "block";
            textAnswer.value = "";
          } else if (riddle.options) {
            multipleChoiceSection.style.display = "block";
            answerOptions.innerHTML = "";
            riddle.options.forEach((option, idx) => {
              const li = document.createElement("li");
              li.textContent = option;
              li.addEventListener("click", function(e) {
                handleMultipleChoiceAnswer(e, option, riddleId, idx);
              });
              answerOptions.appendChild(li);
            });
            if (answers[riddleId]) {
              const selectedIndex = parseInt(answers[riddleId]) - 1;
              const options = document.querySelectorAll("#answer-options li");
              if (options[selectedIndex]) {
                options[selectedIndex].classList.add("selected");
                nextButton.disabled = false;
              }
            }
          } else {
            nextButton.disabled = false;
          }
        }
        updateCumulativeCodeDisplay();
      }

      // Record a multiple-choice answer (digit based on option order, 1-indexed)
      function handleMultipleChoiceAnswer(e, selectedAnswer, riddleId, index) {
        const digit = (index + 1).toString();
        answers[riddleId] = digit;
        updateCumulativeCodeDisplay();
        const options = document.querySelectorAll("#answer-options li");
        options.forEach(option => option.classList.remove("selected"));
        e.currentTarget.classList.add("selected");
        nextButton.disabled = false;
      }

      // Record text input answer (assigning a predetermined digit, here "1")
      function handleTextAnswer() {
        const answer = textAnswer.value.trim();
        if (!answer) return;
        const digit = riddleData[currentRiddle].codeDigit || "1";
        answers[currentRiddle] = digit;
        updateCumulativeCodeDisplay();
        nextButton.disabled = false;
      }

      // Navigate to next riddle
      function navigateToNextRiddle() {
        const currentData = riddleData[currentRiddle];
        if (currentData.isFinal) return;
        if (currentData.answerType === "text" && !answers[currentRiddle]) return;
        currentRiddle = currentData.nextRiddle;
        visitedRiddles.push(currentRiddle);
        loadRiddle(currentRiddle);
        updatePathHistory();
      }

      // Navigate back (does not remove recorded answers)
      function navigateToPreviousRiddle() {
        if (visitedRiddles.length > 1) {
          visitedRiddles.pop();
          currentRiddle = visitedRiddles[visitedRiddles.length - 1];
          loadRiddle(currentRiddle);
          updatePathHistory();
        }
      }

      // Final code submission (expected cumulative code is that for the main branch)
      document.getElementById("final-code-submit").addEventListener("click", function() {
        const finalCodeInput = document.getElementById("final-code-input").value.trim();
        const feedbackElem = document.getElementById("final-code-feedback");
        const expectedCode = "23122332111221323432";
        if (finalCodeInput === expectedCode) {
          feedbackElem.style.color = "green";
          feedbackElem.textContent = "Congratulations! The mystery is solved. The treasure awaits you behind the typewriter!";
        } else {
          feedbackElem.style.color = "red";
          feedbackElem.textContent = "Incorrect code. Your journey may have deviated. Try again.";
        }
      });

      // Event listeners
      nextButton.addEventListener("click", navigateToNextRiddle);
      prevButton.addEventListener("click", navigateToPreviousRiddle);
      submitTextAnswer.addEventListener("click", handleTextAnswer);
      document.getElementById("final-code-input").addEventListener("keypress", function(event) {
        if (event.key === "Enter") {
          document.getElementById("final-code-submit").click();
        }
      });
      textAnswer.addEventListener("keypress", function(event) {
        if (event.key === "Enter") {
          handleTextAnswer();
        }
      });

      // Start the game
      loadRiddle(currentRiddle);
      updatePathHistory();
    </script>
  </body>
</html>
